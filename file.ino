// Includes
#include <ESP8266WiFi.h>
#include <DNSServer.h>
#include <ESP8266WebServer.h>
#include <EEPROM.h>
#define EEPROM_SIZE 1


// User configuration
#define SSID_NAME "Micro:bit-Remote"


String bt ="OFF";
// Init System Settings
const byte HTTP_CODE = 200;
const byte DNS_PORT = 53;
const byte TICK_TIMER = 1000;
const byte LEDPORT = 0;
IPAddress APIP(192, 168, 5, 1); // Gateway
unsigned long bootTime = 0, lastActivity = 0, lastTick = 0, tickCtr = 0;
DNSServer dnsServer; ESP8266WebServer webServer(80);
bool Stato = false;




String CSS = "article { background: #f2f2f2; padding: 1.3em; }"
             "body { color: #333; font-family: Century Gothic, sans-serif; font-size: 18px; line-height: 24px; margin: 0; padding: 0; }"
             "table { width:100% }"
             "div { padding: 0.5em; }"
             "h1 { margin: 0.5em 0 0 0; padding: 0.5em; }"
             "input { width: 60%; padding: 9px 10px; margin: 8px 0; box-sizing: border-box; border-radius: 0; border: 1px solid #555555; font-size: 28px}"
             "label { color: #333; display: block; font-style: italic; font-weight: bold; }"
             "nav { background: #ffa500; color: #fff; display: block; font-size: 1.5em; padding: 1em; }"
             "nav b { display: block; font-size: 1.5em; margin-bottom: 0.5em; } "
             "textarea { width: 100%; }";


String HEAD = "<!DOCTYPE html><html>"
              "<head><title>MICRO:BIT Remote</title>"
              "<meta name=viewport content=\"width=device-width,initial-scale=1\">"
              "<style>" + CSS + "</style></head><body>";
              





//################### estrai il campo arg
String input(String argName) {
  String a = webServer.arg(argName);
  a.replace("<", "&lt;"); a.replace(">", "&gt;");
  a.substring(0, 200); return a;
}


String index() {
  return HEAD + "<form action=/post method=post><nav><table><tr><td><img src=\"data:image/png;base64,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\" /></td><td width='100%' >&nbsp;</td><td><b>MICRO:BIT</b>Controllo Remoto</td></tr></table></nav>"
                "<div><center><h1>Testo:</h1></center></div>"
                "<div><center><input type=text name=TTESTO></input>"
                "<input type=submit value=\"Invia a Micro:bit\">"                
                "<div><center><h1> Stato attuale: "+ bt +"</h1></center></div>"
                "<div><center><input type=submit name=BTT  value='ON' style='background-color:#00AA00'>"              
                "</form></center></body></html>";

}





String posted() {
   String Messaggio = input("TTESTO");
   if(Messaggio != "")
   {
   Serial.println(Messaggio);
   }

 String btx = input("BTT");  
    if(btx !="") {
      bt = btx;
      }
  
    String BTnew ="";
    String BGcolor="";
    
    
    if( bt == "ON" )
    {
      BTnew ="OFF";
      BGcolor ="#ff0000";
      digitalWrite(LEDPORT, HIGH);
      }
    
    else if( bt == "OFF" )
    {
      BTnew ="ON";
      BGcolor ="#00AA00";
      digitalWrite(LEDPORT, LOW);
      //WiFi.softAPdisconnect();
      }
   
  return HEAD + "<form action=/post method=post><nav><table><tr><td><img src=\"data:image/png;base64,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\" /></td><td width='100%' >&nbsp;</td><td><b>MICRO:BIT</b>Controllo Remoto</td></tr></table></nav>"
                "<div><center><h1>Testo:</h1></center></div>"
                "<div><center><input type=text name=TTESTO></input>"
                "<input type=submit value=\"Invia a Micro:bit\">"                
                "<div><center><h1> Stato attuale: "+ bt +"</h1></center></div>"
                "<div><center><input type=submit name=BTT  value='"+ BTnew + "' style='background-color:" + BGcolor + "'>"              
                "</form></center></body></html>";
}



void BLINK() { // The internal LED will blink 5 times when a password is received.
  int count = 0;
  while (count < 5) {
    digitalWrite(LEDPORT, LOW);
    delay(500);
    digitalWrite(LEDPORT, HIGH);
    delay(500);
    count = count + 1;
  }
}

void setup() {
 Serial.begin(115200);
 EEPROM.begin(EEPROM_SIZE);

// read the last LED state from flash memory
  int ledState = EEPROM.read(0);

  // save the LED state in flash memory
    EEPROM.write(0, ledState);
    EEPROM.commit();

  
  bootTime = lastActivity = millis();
  WiFi.hostname("HZRD.RC");
  WiFi.mode(WIFI_AP);
  WiFi.softAPConfig(APIP, APIP, IPAddress(255, 255, 255, 0));
  WiFi.softAP(SSID_NAME);
  dnsServer.start(DNS_PORT, "*", APIP); // DNS spoofing (Only HTTP)  

  webServer.on("/post", []() {
    webServer.send(HTTP_CODE, "text/html", posted());
  });
  
  webServer.onNotFound([]() {
    lastActivity = millis();
    webServer.send(HTTP_CODE, "text/html", index());
  });
  webServer.begin();
  pinMode(LEDPORT, OUTPUT);
  digitalWrite(LEDPORT, LOW);
}


void LoockConne()
{
      WiFi.disconnect(true);
      WiFi.mode( WIFI_OFF );
      delay(10000);
      setup();     
  }



void loop() {
  if ((millis() - lastTick) > TICK_TIMER) {
    lastTick = millis();
  }
  dnsServer.processNextRequest(); webServer.handleClient();
}